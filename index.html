<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Writeups | Marian John</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüõ°Ô∏è%3C/text%3E%3C/svg%3E">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #0d1117;
            --bg-card: #161b22;
            --bg-elevated: #21262d;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-red: #f85149;
            --accent-green: #3fb950;
            --accent-blue: #58a6ff;
            --accent-yellow: #d29922;
            --border: #30363d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.7;
            overflow-x: hidden;
        }

        /* Scanline effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(255, 255, 255, 0.01) 2px,
                rgba(255, 255, 255, 0.01) 4px
            );
            pointer-events: none;
            z-index: 9999;
            opacity: 0.5;
        }

        /* Grid background */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(var(--border) 1px, transparent 1px),
                linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.1;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Header */
        header {
            padding: 3rem 0 2rem;
            text-align: center;
            margin-bottom: 3rem;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 1px solid var(--accent-red);
            color: var(--accent-red);
            text-decoration: none;
            font-family: 'Fira Code', monospace;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: var(--accent-red);
            color: var(--bg-dark);
        }

        h1 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 700;
            margin-bottom: 1rem;
            letter-spacing: -2px;
            background: linear-gradient(135deg, var(--accent-red), var(--accent-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-family: 'Fira Code', monospace;
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        /* Stats Banner */
        .stats-banner {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
            padding: 2rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-family: 'Fira Code', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-green);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Platform Category Cards */
        .platform-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .category-card {
            background: var(--bg-card);
            border: 2px solid;
            padding: 2.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }

        .category-card:hover::before {
            transform: scaleX(1);
        }

        .category-card:hover {
            transform: translateY(-10px);
        }

        .category-icon {
            font-size: 3.5rem;
            margin-bottom: 1rem;
        }

        .category-title {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Fira Code', monospace;
            margin-bottom: 0.5rem;
            letter-spacing: -1px;
        }

        .category-count {
            font-family: 'Fira Code', monospace;
            font-size: 1rem;
            opacity: 0.7;
            margin-bottom: 1rem;
        }

        .category-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .view-writeups-btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border: 1px solid;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .view-writeups-btn:hover {
            transform: translateX(5px);
        }

        /* Platform Sections */
        .platform-section {
            margin-bottom: 5rem;
            display: none;
        }

        .platform-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .platform-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid;
        }

        .platform-icon {
            font-size: 2.5rem;
        }

        .platform-title {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Fira Code', monospace;
            letter-spacing: -1px;
        }

        .platform-count {
            margin-left: auto;
            font-family: 'Fira Code', monospace;
            font-size: 1.2rem;
            opacity: 0.7;
        }

        .back-to-categories {
            display: inline-block;
            margin-bottom: 2rem;
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            text-decoration: none;
            font-family: 'Fira Code', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-to-categories:hover {
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        /* Writeups Grid */
        .writeups-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
        }

        .writeup-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .writeup-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }

        .writeup-card:hover {
            transform: translateY(-5px);
        }

        .writeup-card:hover::before {
            transform: scaleX(1);
        }

        .writeup-card h3 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
            font-weight: 600;
            line-height: 1.3;
        }

        .writeup-meta {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .badge {
            padding: 0.3rem 0.75rem;
            font-size: 0.7rem;
            font-family: 'Fira Code', monospace;
            border: 1px solid;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge.easy {
            background: rgba(63, 185, 80, 0.1);
            color: var(--accent-green);
            border-color: rgba(63, 185, 80, 0.3);
        }

        .badge.medium {
            background: rgba(210, 153, 34, 0.1);
            color: var(--accent-yellow);
            border-color: rgba(210, 153, 34, 0.3);
        }

        .badge.hard {
            background: rgba(248, 81, 73, 0.1);
            color: var(--accent-red);
            border-color: rgba(248, 81, 73, 0.3);
        }

        .writeup-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.95rem;
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .writeup-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .tag {
            font-family: 'Fira Code', monospace;
            font-size: 0.7rem;
            padding: 0.25rem 0.6rem;
            border: 1px solid;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 4rem;
            color: var(--text-secondary);
        }

        .loading-spinner {
            font-size: 2rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 4rem;
            color: var(--text-muted);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        /* Footer */
        footer {
            margin-top: 6rem;
            padding: 3rem 0;
            border-top: 1px solid var(--border);
            text-align: center;
            color: var(--text-muted);
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 1.5rem;
            }

            .writeups-grid {
                grid-template-columns: 1fr;
            }

            .platform-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .platform-count {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="https://marianjosephjeffrey.com" class="back-link">‚Üê Back to Portfolio</a>
            <h1>Security Writeups</h1>
            <p class="subtitle">TryHackMe ‚Ä¢ KC7 ‚Ä¢ Hack The Box</p>
        </header>

        <div class="stats-banner">
            <div class="stat-item">
                <div class="stat-value" id="total-writeups">...</div>
                <div class="stat-label">Total Writeups</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">TOP 1%</div>
                <div class="stat-label">TryHackMe Rank</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">TOP 11%</div>
                <div class="stat-label">NCL CTF</div>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="loading-spinner">‚è≥</div>
            <p>Loading writeups from GitHub...</p>
        </div>

        <!-- Category Cards (shown first) -->
        <div id="categories-container" class="platform-categories" style="display: none;"></div>

        <!-- Platform Sections (shown when category clicked) -->
        <div id="platforms-container"></div>

        <footer>
            <p>¬© 2026 Marian John ‚Ä¢ Built with security in mind üõ°Ô∏è</p>
        </footer>
    </div>

    <script>
        // CONFIGURATION
        const CONFIG = {
            username: 'marianjosephjeffrey',
            repo: 'marianjosephjeffrey.github.io',
            branch: 'main',
            platforms: {
                'TryHackMe': {
                    icon: 'üéØ',
                    color: '#3fb950',
                    glowColor: 'rgba(63, 185, 80, 0.15)'
                },
                'KC7': {
                    icon: 'üîç',
                    color: '#58a6ff',
                    glowColor: 'rgba(88, 166, 255, 0.15)'
                },
                'HackTheBox': {
                    icon: 'üì¶',
                    color: '#f85149',
                    glowColor: 'rgba(248, 81, 73, 0.15)'
                }
            }
        };

        // Extract metadata from Notion-style HTML
        function extractMetadataFromHTML(htmlContent, filename) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, 'text/html');
            
            let metadata = {
                title: '',
                description: '',
                difficulty: 'Medium',
                categories: [],
                skills: [],
                platform: 'Unknown'
            };
            
            // Extract title from h1
            const h1 = doc.querySelector('h1.page-title');
            if (h1) {
                metadata.title = h1.textContent.trim();
            } else {
                metadata.title = decodeURIComponent(filename.replace(/\.html?$/i, '')).replace(/%20/g, ' ');
            }
            
            // Extract metadata from Notion property table
            const propertyRows = doc.querySelectorAll('tr.property-row');
            
            propertyRows.forEach(row => {
                const iconSpan = row.querySelector('span.icon.property-icon');
                const valueSpan = row.querySelector('span.selected-value');
                
                if (!iconSpan || !valueSpan) return;
                
                const propertyName = iconSpan.nextSibling?.textContent?.trim() || '';
                const propertyValue = valueSpan.textContent.trim();
                
                // Platform
                if (propertyName.toLowerCase().includes('platform')) {
                    metadata.platform = propertyValue;
                }
                
                // Description
                if (propertyName.toLowerCase().includes('description')) {
                    metadata.description = propertyValue;
                }
                
                // Difficulty
                if (propertyName.toLowerCase().includes('difficulty')) {
                    metadata.difficulty = propertyValue;
                }
                
                // Category (can have multiple values)
                if (propertyName.toLowerCase().includes('category')) {
                    // Multiple values might be in separate spans
                    const allValues = row.querySelectorAll('span.selected-value');
                    metadata.categories = Array.from(allValues).map(v => v.textContent.trim()).filter(v => v);
                }
                
                // Skills Learned
                if (propertyName.toLowerCase().includes('skill')) {
                    const allValues = row.querySelectorAll('span.selected-value');
                    metadata.skills = Array.from(allValues).map(v => v.textContent.trim()).filter(v => v);
                }
            });
            
            // Also check for multi-select rows (categories/skills often use this)
            const multiSelectRows = doc.querySelectorAll('tr.property-row-multi_select');
            multiSelectRows.forEach(row => {
                const values = row.querySelectorAll('span.selected-value');
                const propertyName = row.querySelector('span.icon.property-icon')?.nextSibling?.textContent?.trim() || '';
                
                if (propertyName.toLowerCase().includes('category')) {
                    metadata.categories = Array.from(values).map(v => v.textContent.trim()).filter(v => v);
                }
                if (propertyName.toLowerCase().includes('skill')) {
                    metadata.skills = Array.from(values).map(v => v.textContent.trim()).filter(v => v);
                }
            });
            
            // Fallback description from first paragraph
            if (!metadata.description) {
                const firstP = doc.querySelector('div.page-body p');
                if (firstP && firstP.textContent.length > 20) {
                    metadata.description = firstP.textContent.trim().substring(0, 200);
                }
            }
            
            return metadata;
        }

        // Fetch all writeups from root directory
        async function fetchAllWriteups() {
            const writeups = [];
            
            try {
                const apiUrl = `https://api.github.com/repos/${CONFIG.username}/${CONFIG.repo}/contents?ref=${CONFIG.branch}`;
                const response = await fetch(apiUrl);
                
                if (!response.ok) return writeups;
                
                const files = await response.json();
                const htmlFiles = files.filter(f => 
                    f.type === 'file' && 
                    (f.name.endsWith('.html') || f.name.endsWith('.htm')) &&
                    f.name.toLowerCase() !== 'index.html'
                );

                for (const file of htmlFiles) {
                    try {
                        const contentResponse = await fetch(file.download_url);
                        const content = await contentResponse.text();
                        
                        const metadata = extractMetadataFromHTML(content, file.name);
                        
                        writeups.push({
                            ...metadata,
                            filename: file.name,
                            url: encodeURIComponent(file.name)
                        });
                    } catch (error) {
                        console.error(`Error processing ${file.name}:`, error);
                    }
                }
            } catch (error) {
                console.error('Error fetching writeups:', error);
            }
            
            return writeups;
        }

        // Group writeups by platform
        function groupByPlatform(writeups) {
            const grouped = {
                'TryHackMe': [],
                'KC7': [],
                'HackTheBox': []
            };
            
            writeups.forEach(writeup => {
                const platform = writeup.platform;
                
                // Match platform to our categories
                if (platform.toLowerCase().includes('tryhackme')) {
                    grouped['TryHackMe'].push(writeup);
                } else if (platform.toLowerCase().includes('kc7')) {
                    grouped['KC7'].push(writeup);
                } else if (platform.toLowerCase().includes('hackthebox') || platform.toLowerCase().includes('hack the box')) {
                    grouped['HackTheBox'].push(writeup);
                } else {
                    // Default to TryHackMe if unknown
                    grouped['TryHackMe'].push(writeup);
                }
            });
            
            return grouped;
        }

        // Render category card
        function renderCategoryCard(platform, writeups, config) {
            const descriptions = {
                'TryHackMe': 'Interactive cybersecurity challenges covering web exploitation, privilege escalation, and network security.',
                'KC7': 'Advanced digital forensics and incident response challenges focusing on log analysis and threat hunting.',
                'HackTheBox': 'Penetration testing labs with realistic vulnerable machines and security scenarios.'
            };
            
            return `
                <div class="category-card" 
                     style="border-color: ${config.color};"
                     onmouseover="this.style.boxShadow='0 15px 50px ${config.glowColor}'; this.querySelector('.category-card-before').style.background='${config.color}';"
                     onmouseout="this.style.boxShadow='none';"
                     onclick="showPlatform('${platform}')">
                    <div class="category-card-before" style="position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: ${config.color}; transform: scaleX(0); transition: transform 0.3s;"></div>
                    <div class="category-icon">${config.icon}</div>
                    <h3 class="category-title" style="color: ${config.color};">${platform}</h3>
                    <p class="category-count">${writeups.length} writeup${writeups.length !== 1 ? 's' : ''}</p>
                    <p class="category-description">${descriptions[platform] || ''}</p>
                    <div class="view-writeups-btn" style="color: ${config.color}; border-color: ${config.color};">
                        View Writeups ‚Üí
                    </div>
                </div>
            `;
        }

        // Render writeups for a platform
        function renderPlatform(platform, writeups, config) {
            if (writeups.length === 0) return '';
            
            const cardsHTML = writeups.map(writeup => `
                <div class="writeup-card" 
                     style="border-color: ${config.color}20;"
                     onclick="window.open('${writeup.url}', '_blank')"
                     onmouseover="this.style.borderColor='${config.color}'; this.style.boxShadow='0 10px 40px ${config.glowColor}'"
                     onmouseout="this.style.borderColor='${config.color}20'; this.style.boxShadow='none'">
                    <div style="position: absolute; top: 0; left: 0; right: 0; height: 3px; background: ${config.color};"></div>
                    <h3>${writeup.title}</h3>
                    <div class="writeup-meta">
                        <span class="badge ${writeup.difficulty.toLowerCase()}">${writeup.difficulty}</span>
                        ${writeup.categories.length > 0 ? writeup.categories.map(cat => 
                            `<span class="badge" style="background: ${config.color}20; color: ${config.color}; border-color: ${config.color}60;">${cat}</span>`
                        ).join('') : ''}
                    </div>
                    ${writeup.description ? `<p class="writeup-description">${writeup.description}</p>` : ''}
                    ${writeup.skills.length > 0 ? `
                        <div class="writeup-tags">
                            ${writeup.skills.map(skill => 
                                `<span class="tag" style="background: ${config.color}10; color: ${config.color}; border-color: ${config.color}40;">${skill}</span>`
                            ).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
            
            return `
                <div class="platform-section" id="section-${platform}">
                    <button class="back-to-categories" onclick="showCategories()">
                        ‚Üê Back to Categories
                    </button>
                    <div class="platform-header" style="border-color: ${config.color};">
                        <span class="platform-icon">${config.icon}</span>
                        <h2 class="platform-title" style="color: ${config.color};">${platform}</h2>
                        <span class="platform-count">${writeups.length} writeup${writeups.length !== 1 ? 's' : ''}</span>
                    </div>
                    <div class="writeups-grid">
                        ${cardsHTML}
                    </div>
                </div>
            `;
        }

        // Navigation functions
        function showCategories() {
            document.getElementById('categories-container').style.display = 'grid';
            document.querySelectorAll('.platform-section').forEach(section => {
                section.classList.remove('active');
            });
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showPlatform(platform) {
            document.getElementById('categories-container').style.display = 'none';
            document.querySelectorAll('.platform-section').forEach(section => {
                section.classList.remove('active');
            });
            const section = document.getElementById(`section-${platform}`);
            if (section) {
                section.classList.add('active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Initialize
        async function init() {
            const loadingEl = document.getElementById('loading');
            const categoriesEl = document.getElementById('categories-container');
            const platformsEl = document.getElementById('platforms-container');
            const totalEl = document.getElementById('total-writeups');
            
            // Fetch all writeups from root
            const allWriteups = await fetchAllWriteups();
            
            // Group by platform based on metadata
            const groupedWriteups = groupByPlatform(allWriteups);
            
            let totalCount = 0;
            let categoryHTML = '';
            let platformHTML = '';
            
            for (const [platform, config] of Object.entries(CONFIG.platforms)) {
                const writeups = groupedWriteups[platform] || [];
                totalCount += writeups.length;
                
                // Build category cards
                categoryHTML += renderCategoryCard(platform, writeups, config);
                
                // Build platform sections
                platformHTML += renderPlatform(platform, writeups, config);
            }
            
            loadingEl.style.display = 'none';
            categoriesEl.innerHTML = categoryHTML;
            platformsEl.innerHTML = platformHTML;
            categoriesEl.style.display = 'grid';
            totalEl.textContent = totalCount;
            
            console.log(`‚úÖ Loaded ${totalCount} writeups`);
            console.log('Breakdown:', {
                TryHackMe: groupedWriteups['TryHackMe'].length,
                KC7: groupedWriteups['KC7'].length,
                HackTheBox: groupedWriteups['HackTheBox'].length
            });
        }

        // Make functions globally available
        window.showCategories = showCategories;
        window.showPlatform = showPlatform;

        init();
    </script>
</body>
</html>
